---
title: 使用 makefile 来简化 c 文件的编译和链接(working draft)
category: c 
---

虽然说我的主攻方向并不在 c 方面，但是多学点东西还是更好一点的，思路就更加广阔，并且日常生活中复习数据结构的时候还是会使用 c 来刷题、练习算法。

我使用的是 `Ubuntu15.04` ，以下的内容摘录于 鸟哥的linux私房菜 书籍并结合了自己的理解。

- 首先先来介绍如果不通过 makefile 来编译和链接 c 程序：

    假设存在如下的两个文件：
    
        //thanks.c
        #include <stdio.h>
        
        int main(void)
        
        {
            printf("Hello world\n");
            
            thanks2();
            
            return 0;
        }
        
        //thanks2.c
        #include <stdio.h>
        
        void thanks2()
        
        {
            printf("Thanks you!\n");
            
            return;
        }
    
    接下来编译和链接：
    
        gcc -c thanks.c thanks2.c   //通过了执行这个命令之后，当前的目录中就会生成相应的 *.o 目标文件
        
        gcc -o thanks thanks.o thanks2.o  //链接生成可执行文件
        
    在这里讲解以下为什么不一步由源文件生成可执行文件，而要通过生成目标文件再来生成可执行文件？
    
    原因就是编译一个大型文件的时候，会花费很长的时间。如果有一天你更新了其中的一个文件内容，并且原本是通过生成目标文件的方式进行链接的话，这个时候的你就会感到十分的幸运，因为你只要重新编译你修改过的源文件来生成相应的目标文件，然后再以链接制出新的二进制可执行文件即可。不然如果你的文件数目很多并且每一个文件的内容又十分的多的时候，我就不确定你要编译多久了...
    
    其实在编译的过程中，我们可以通过添加适当的参数，使得程序在执行的时候具有比较好的性能以及一定的调试功能：
    
        -O 大写字母 O 为生成优化的参数，优化执行速度
    
        -Wall 添加这个参数可以产生更加详细的编译过程，输出警告信息
        
- 使用 makefile 来编译和链接 c 程序

    先来看看我日常编译和链接 c 程序的 makefile 文件吧：
    
        OBJS = xm.o
        CFLAGS = -Wall -O
        
        a : ${OBJS}
        	gcc -o xm ${OBJS}
        
        x : 
        	./xm
    
    

        
